Climate Futures Toolbox
================

# Welcome to the Climate Futures Toolbox

This is a package developed as a collaboration between Earth lab and the
North Central Climate Adaptation Science Center to help users gain
insights from available climate data. This package includes tools and
instructions for downloading climate data via a USGS API and then
organizing those data for visualization and analysis that drive insight.

This package is currently growing to include better functionality for
spatial analyses and more user-friendly features. Thank you for all the
wonderful beta tester groups that helped us get the software this far.
Please be patient as we update some of the functions and vignette to
accommodate more functionality.

# What you’ll find here

This vignette provides a walk-through of a common use case of the cft
package, which is, to help users download, organize, and visualize past
and future climate data.

1.  How to download and install the cft package
2.  How to see the menu of available data and choose items from that
    menu
3.  A description of both functions available in the cft package and
    their primary usage cases

## Why write the cft package?

The amount of data generated by downscaled GCMs can be quite large
(e.g., daily data at a few km spatial resolution). The Climate Futures
Toolbox was developed to help users access and use smaller subsets.

Data is acquired from the [Northwest Knowledge Server of the University
of
Idaho](http://thredds.northwestknowledge.net:8080/thredds/reacch_climate_CMIP5_macav2_catalog2.html).

### What you’ll need

To get the most out of this vignette, we assume you have:

- At least 500 MB of disk space
- Some familiarity with ggplot2
- Some familiarity with dplyr (e.g.,
  [`filter()`](https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/filter),
  [`group_by()`](https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/group_by),
  and
  [`summarise()`](https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/summarise))

## About the data

Global Circulation Models (GCMs) provide estimates of historical and
future climate conditions. The complexity of the climate system has lead
to a large number GCMs and it is common practice to examine outputs from
many different models, treating each as one plausible future.

Most GCMs are spatially coarse (often 1 degree), but downscaling
provides finer scale estimates. The cft package uses one downscaled
climate model called MACA (Multivariate Adaptive Climate Analog) Version
2 ([details here](http://www.climatologylab.org/maca.html)).

# Loading the cft package from github

``` r
library(devtools)
install_github("earthlab/cft", force = TRUE)
```

## Attach cft and check the list of available functions

``` r
library(multidplyr)
library(cft)
ls(pos="package:cft")
```

    ##   [1] "%->%"                         "%<-%"                        
    ##   [3] "%>%"                          "%>>%"                        
    ##   [5] "%conditions%"                 "%globals%"                   
    ##   [7] "%label%"                      "%lazy%"                      
    ##   [9] "%packages%"                   "%plan%"                      
    ##  [11] "%seed%"                       "%stdout%"                    
    ##  [13] "%tweak%"                      "a_ply"                       
    ##  [15] "aaply"                        "activate"                    
    ##  [17] "active"                       "active<-"                    
    ##  [19] "add_osm_feature"              "add_osm_features"            
    ##  [21] "adply"                        "ageadjust.direct"            
    ##  [23] "ageadjust.indirect"           "all_of"                      
    ##  [25] "alply"                        "amv_dimnames"                
    ##  [27] "any_of"                       "arrange"                     
    ##  [29] "as_Spatial"                   "as_tibble"                   
    ##  [31] "as.cluster"                   "as.FutureGlobals"            
    ##  [33] "as.hour"                      "as.month"                    
    ##  [35] "as.quoted"                    "as.week"                     
    ##  [37] "autoStopCluster"              "available_data"              
    ##  [39] "available_features"           "available_tags"              
    ##  [41] "availableCores"               "availableWorkers"            
    ##  [43] "backtrace"                    "bbox_to_string"              
    ##  [45] "binom.approx"                 "binom.exact"                 
    ##  [47] "binom.wilson"                 "build_longer_spec"           
    ##  [49] "build_wider_spec"             "catcolwise"                  
    ##  [51] "check_pivot_spec"             "chop"                        
    ##  [53] "cluster"                      "ClusterFuture"               
    ##  [55] "colorbrewer.data"             "colorbrewer.display"         
    ##  [57] "colorbrewer.palette"          "colors.matrix"               
    ##  [59] "colors.plot"                  "colwise"                     
    ##  [61] "compact"                      "complete"                    
    ##  [63] "complete_"                    "ConstantFuture"              
    ##  [65] "contains"                     "count"                       
    ##  [67] "create_progress_bar"          "crossing"                    
    ##  [69] "crossing_"                    "d_ply"                       
    ##  [71] "daply"                        "dbDataType"                  
    ##  [73] "dbWriteTable"                 "ddply"                       
    ##  [75] "defaults"                     "desc"                        
    ##  [77] "dlply"                        "drop_na"                     
    ##  [79] "drop_na_"                     "each"                        
    ##  [81] "empty"                        "ends_with"                   
    ##  [83] "epicurve.dates"               "epicurve.hours"              
    ##  [85] "epicurve.months"              "epicurve.table"              
    ##  [87] "epicurve.weeks"               "epidate"                     
    ##  [89] "epitab"                       "epitable"                    
    ##  [91] "eval.quoted"                  "everything"                  
    ##  [93] "expand"                       "expand_"                     
    ##  [95] "expand_grid"                  "expand.table"                
    ##  [97] "expected"                     "extract"                     
    ##  [99] "extract_"                     "extract_numeric"             
    ## [101] "failwith"                     "fill"                        
    ## [103] "fill_"                        "full_seq"                    
    ## [105] "furrr_options"                "future"                      
    ## [107] "Future"                       "future_imap"                 
    ## [109] "future_imap_chr"              "future_imap_dbl"             
    ## [111] "future_imap_dfc"              "future_imap_dfr"             
    ## [113] "future_imap_int"              "future_imap_lgl"             
    ## [115] "future_imap_raw"              "future_invoke_map"           
    ## [117] "future_invoke_map_chr"        "future_invoke_map_dbl"       
    ## [119] "future_invoke_map_dfc"        "future_invoke_map_dfr"       
    ## [121] "future_invoke_map_int"        "future_invoke_map_lgl"       
    ## [123] "future_invoke_map_raw"        "future_iwalk"                
    ## [125] "future_map"                   "future_map_at"               
    ## [127] "future_map_chr"               "future_map_dbl"              
    ## [129] "future_map_dfc"               "future_map_dfr"              
    ## [131] "future_map_if"                "future_map_int"              
    ## [133] "future_map_lgl"               "future_map_raw"              
    ## [135] "future_map2"                  "future_map2_chr"             
    ## [137] "future_map2_dbl"              "future_map2_dfc"             
    ## [139] "future_map2_dfr"              "future_map2_int"             
    ## [141] "future_map2_lgl"              "future_map2_raw"             
    ## [143] "future_modify"                "future_modify_at"            
    ## [145] "future_modify_if"             "future_options"              
    ## [147] "future_pmap"                  "future_pmap_chr"             
    ## [149] "future_pmap_dbl"              "future_pmap_dfc"             
    ## [151] "future_pmap_dfr"              "future_pmap_int"             
    ## [153] "future_pmap_lgl"              "future_pmap_raw"             
    ## [155] "future_pwalk"                 "future_walk"                 
    ## [157] "future_walk2"                 "futureAssign"                
    ## [159] "futureCall"                   "FutureCondition"             
    ## [161] "FutureError"                  "FutureGlobals"               
    ## [163] "FutureMessage"                "futureOf"                    
    ## [165] "FutureResult"                 "futures"                     
    ## [167] "futureSessionInfo"            "FutureWarning"               
    ## [169] "gather"                       "gather_"                     
    ## [171] "gdal_addo"                    "gdal_create"                 
    ## [173] "gdal_crs"                     "gdal_extract"                
    ## [175] "gdal_inv_geotransform"        "gdal_metadata"               
    ## [177] "gdal_polygonize"              "gdal_rasterize"              
    ## [179] "gdal_read"                    "gdal_read_mdim"              
    ## [181] "gdal_subdatasets"             "gdal_utils"                  
    ## [183] "gdal_write"                   "gdal_write_mdim"             
    ## [185] "get_key_pos"                  "get_overpass_url"            
    ## [187] "getbb"                        "getExpression"               
    ## [189] "getGlobalsAndPackages"        "here"                        
    ## [191] "hoist"                        "hyper_array"                 
    ## [193] "hyper_dims"                   "hyper_filter"                
    ## [195] "hyper_grids"                  "hyper_slice"                 
    ## [197] "hyper_tbl_cube"               "hyper_tibble"                
    ## [199] "hyper_transforms"             "hyper_vars"                  
    ## [201] "id"                           "idata.frame"                 
    ## [203] "is.discrete"                  "is.formula"                  
    ## [205] "is.quoted"                    "isplit2"                     
    ## [207] "join"                         "join_all"                    
    ## [209] "join.keys"                    "julian2date"                 
    ## [211] "kapmeier"                     "l_ply"                       
    ## [213] "laply"                        "last_col"                    
    ## [215] "ldply"                        "left_join"                   
    ## [217] "library.dynam"                "library.dynam.unload"        
    ## [219] "liply"                        "List"                        
    ## [221] "list.all"                     "list.any"                    
    ## [223] "list.append"                  "list.apply"                  
    ## [225] "list.cases"                   "list.cbind"                  
    ## [227] "list.class"                   "list.clean"                  
    ## [229] "list.common"                  "list.count"                  
    ## [231] "list.do"                      "list.exclude"                
    ## [233] "list.expand"                  "list.extract"                
    ## [235] "list.filter"                  "list.find"                   
    ## [237] "list.findi"                   "list.first"                  
    ## [239] "list.flatten"                 "list.group"                  
    ## [241] "list.if"                      "list.insert"                 
    ## [243] "list.is"                      "list.iter"                   
    ## [245] "list.join"                    "list.last"                   
    ## [247] "list.load"                    "list.map"                    
    ## [249] "list.maps"                    "list.mapv"                   
    ## [251] "list.match"                   "list.merge"                  
    ## [253] "list.names"                   "list.order"                  
    ## [255] "list.parse"                   "list.prepend"                
    ## [257] "list.rbind"                   "list.remove"                 
    ## [259] "list.reverse"                 "list.sample"                 
    ## [261] "list.save"                    "list.search"                 
    ## [263] "list.select"                  "list.serialize"              
    ## [265] "list.skip"                    "list.skipWhile"              
    ## [267] "list.sort"                    "list.stack"                  
    ## [269] "list.subset"                  "list.table"                  
    ## [271] "list.take"                    "list.takeWhile"              
    ## [273] "list.ungroup"                 "list.unserialize"            
    ## [275] "list.unzip"                   "list.update"                 
    ## [277] "list.which"                   "list.zip"                    
    ## [279] "llply"                        "m_ply"                       
    ## [281] "makeClusterMPI"               "makeClusterPSOCK"            
    ## [283] "makeNodePSOCK"                "mandelbrot"                  
    ## [285] "mandelbrot_tiles"             "maply"                       
    ## [287] "mapvalues"                    "match_df"                    
    ## [289] "matches"                      "mdply"                       
    ## [291] "mlply"                        "multicore"                   
    ## [293] "MulticoreFuture"              "multiprocess"                
    ## [295] "MultiprocessFuture"           "multisession"                
    ## [297] "MultisessionFuture"           "mutate"                      
    ## [299] "NA_agr_"                      "NA_bbox_"                    
    ## [301] "NA_crs_"                      "NA_m_range_"                 
    ## [303] "NA_z_range_"                  "name_rows"                   
    ## [305] "nbrOfFreeWorkers"             "nbrOfWorkers"                
    ## [307] "nest"                         "nest_"                       
    ## [309] "nest_legacy"                  "nesting"                     
    ## [311] "nesting_"                     "num_range"                   
    ## [313] "numcolwise"                   "oddsratio"                   
    ## [315] "oddsratio.fisher"             "oddsratio.midp"              
    ## [317] "oddsratio.small"              "oddsratio.wald"              
    ## [319] "one_of"                       "opq"                         
    ## [321] "opq_around"                   "opq_enclosing"               
    ## [323] "opq_osm_id"                   "opq_string"                  
    ## [325] "or.midp"                      "ormidp.test"                 
    ## [327] "osm_elevation"                "osm_lines"                   
    ## [329] "osm_multilines"               "osm_multipolygons"           
    ## [331] "osm_points"                   "osm_poly2line"               
    ## [333] "osm_polygons"                 "osmdata"                     
    ## [335] "osmdata_sc"                   "osmdata_sf"                  
    ## [337] "osmdata_sp"                   "osmdata_xml"                 
    ## [339] "overpass_status"              "pack"                        
    ## [341] "Pipe"                         "pipeline"                    
    ## [343] "pivot_longer"                 "pivot_longer_spec"           
    ## [345] "pivot_wider"                  "pivot_wider_spec"            
    ## [347] "pivot_wider.sf"               "plan"                        
    ## [349] "plot_sf"                      "pois.approx"                 
    ## [351] "pois.byar"                    "pois.daly"                   
    ## [353] "pois.exact"                   "probratio"                   
    ## [355] "progress_none"                "progress_text"               
    ## [357] "progress_time"                "progress_tk"                 
    ## [359] "progress_win"                 "quickdf"                     
    ## [361] "r_ply"                        "raply"                       
    ## [363] "rate2by2.test"                "rateratio"                   
    ## [365] "rateratio.midp"               "rateratio.wald"              
    ## [367] "ratetable"                    "rawToHex"                    
    ## [369] "rbind.fill"                   "rbind.fill.matrix"           
    ## [371] "rdply"                        "read_sf"                     
    ## [373] "remote"                       "rename"                      
    ## [375] "replace_na"                   "resetWorkers"                
    ## [377] "resolve"                      "resolved"                    
    ## [379] "result"                       "revalue"                     
    ## [381] "riskratio"                    "riskratio.boot"              
    ## [383] "riskratio.small"              "riskratio.wald"              
    ## [385] "rlply"                        "RngFutureCondition"          
    ## [387] "RngFutureError"               "RngFutureWarning"            
    ## [389] "round_any"                    "run"                         
    ## [391] "select"                       "separate"                    
    ## [393] "separate_"                    "separate_rows"               
    ## [395] "separate_rows_"               "sequential"                  
    ## [397] "SequentialFuture"             "sessionDetails"              
    ## [399] "set_overpass_url"             "sf_add_proj_units"           
    ## [401] "sf_extSoftVersion"            "sf_proj_info"                
    ## [403] "sf_proj_network"              "sf_proj_pipelines"           
    ## [405] "sf_proj_search_paths"         "sf_project"                  
    ## [407] "sf_use_s2"                    "sf.colors"                   
    ## [409] "single_point_firehose"        "splat"                       
    ## [411] "split_indices"                "split_labels"                
    ## [413] "spread"                       "spread_"                     
    ## [415] "st_agr"                       "st_agr<-"                    
    ## [417] "st_area"                      "st_as_binary"                
    ## [419] "st_as_grob"                   "st_as_s2"                    
    ## [421] "st_as_sf"                     "st_as_sfc"                   
    ## [423] "st_as_text"                   "st_axis_order"               
    ## [425] "st_bbox"                      "st_bind_cols"                
    ## [427] "st_boundary"                  "st_buffer"                   
    ## [429] "st_cast"                      "st_centroid"                 
    ## [431] "st_collection_extract"        "st_combine"                  
    ## [433] "st_contains"                  "st_contains_properly"        
    ## [435] "st_convex_hull"               "st_coordinates"              
    ## [437] "st_covered_by"                "st_covers"                   
    ## [439] "st_crop"                      "st_crosses"                  
    ## [441] "st_crs"                       "st_crs<-"                    
    ## [443] "st_delete"                    "st_difference"               
    ## [445] "st_dimension"                 "st_disjoint"                 
    ## [447] "st_distance"                  "st_drivers"                  
    ## [449] "st_drop_geometry"             "st_equals"                   
    ## [451] "st_equals_exact"              "st_filter"                   
    ## [453] "st_geometry"                  "st_geometry_type"            
    ## [455] "st_geometry<-"                "st_geometrycollection"       
    ## [457] "st_graticule"                 "st_inscribed_circle"         
    ## [459] "st_interpolate_aw"            "st_intersection"             
    ## [461] "st_intersects"                "st_is"                       
    ## [463] "st_is_empty"                  "st_is_longlat"               
    ## [465] "st_is_simple"                 "st_is_valid"                 
    ## [467] "st_is_within_distance"        "st_jitter"                   
    ## [469] "st_join"                      "st_layers"                   
    ## [471] "st_length"                    "st_line_merge"               
    ## [473] "st_line_sample"               "st_linestring"               
    ## [475] "st_m_range"                   "st_make_grid"                
    ## [477] "st_make_valid"                "st_minimum_rotated_rectangle"
    ## [479] "st_multilinestring"           "st_multipoint"               
    ## [481] "st_multipolygon"              "st_nearest_feature"          
    ## [483] "st_nearest_points"            "st_node"                     
    ## [485] "st_normalize"                 "st_overlaps"                 
    ## [487] "st_point"                     "st_point_on_surface"         
    ## [489] "st_polygon"                   "st_polygonize"               
    ## [491] "st_precision"                 "st_precision<-"              
    ## [493] "st_read"                      "st_read_db"                  
    ## [495] "st_relate"                    "st_reverse"                  
    ## [497] "st_sample"                    "st_segmentize"               
    ## [499] "st_set_agr"                   "st_set_crs"                  
    ## [501] "st_set_geometry"              "st_set_precision"            
    ## [503] "st_sf"                        "st_sfc"                      
    ## [505] "st_shift_longitude"           "st_simplify"                 
    ## [507] "st_snap"                      "st_sym_difference"           
    ## [509] "st_touches"                   "st_transform"                
    ## [511] "st_triangulate"               "st_union"                    
    ## [513] "st_viewport"                  "st_voronoi"                  
    ## [515] "st_within"                    "st_wrap_dateline"            
    ## [517] "st_write"                     "st_write_db"                 
    ## [519] "st_z_range"                   "st_zm"                       
    ## [521] "starts_with"                  "strip_splits"                
    ## [523] "summarise"                    "summarize"                   
    ## [525] "supportsMulticore"            "system.file"                 
    ## [527] "tab2by2.test"                 "table.margins"               
    ## [529] "take"                         "tibble"                      
    ## [531] "tidync"                       "tidyr_legacy"                
    ## [533] "transparent"                  "TransparentFuture"           
    ## [535] "tribble"                      "trim_osmdata"                
    ## [537] "true"                         "try_default"                 
    ## [539] "tryapply"                     "tryEval"                     
    ## [541] "tryGet"                       "tryNULL"                     
    ## [543] "tweak"                        "unchop"                      
    ## [545] "uncount"                      "UnexpectedFutureResultError" 
    ## [547] "UniprocessFuture"             "unique_osmdata"              
    ## [549] "unite"                        "unite_"                      
    ## [551] "unname_osmdata_sf"            "unnest"                      
    ## [553] "unnest_"                      "unnest_auto"                 
    ## [555] "unnest_legacy"                "unnest_longer"               
    ## [557] "unnest_wider"                 "unpack"                      
    ## [559] "unrowname"                    "vaggregate"                  
    ## [561] "value"                        "values"                      
    ## [563] "vec_cast.sfc"                 "vec_ptype2.sfc"              
    ## [565] "write_sf"

## Look at the documentation for those functions

``` r
?available_data
```

    ## ℹ Rendering development documentation for "available_data"

``` r
?single_point_firehose
```

    ## ℹ Rendering development documentation for "single_point_firehose"

# Use read-only mode to find available data without initiating a full download.

``` r
inputs <- cft::available_data()
```

    ## Trying to connect to the USGS.gov API

    ## not a file: 
    ## ' https://cida.usgs.gov/thredds/dodsC/macav2metdata_daily_future '
    ## 
    ## ... attempting remote connection

    ## Connection succeeded.

    ## Reading results

    ## Converting into an R data.table

# Donwloading Data

There are too many data available to download in a single download
request. You will need limit your requests to 500 MB. This is enough to
download a single variable for a single spatial point for the full
available time period, but not more than that. This means that we must
filter the results from available_data() to specify the data that we
want to actually download. If you want to pull multiple variables and/or
multiple spatial locations, you will need to submit multiple request for
data and merge those tables together after download. We provide examples
for both.

Notice that if you want to download multiple variables in their entirety
for several specific lat/long locations, single_point_firehose() will
provide better functionality than available_data(). The
single_point_firehose() function parallelizes the download requests,
which allows it to download a large quantity of data much faster than
the available_data() function. Additionally, the single_point_firehose()
function combines the data from the parallelized download requests into
a single sf spatial dataframe. A vignette walking through a common use
of the single_point_firehose() function can be found at
<https://github.com/earthlab/cft/blob/main/vignettes/firehose.md>

## We can look at just the unique variable types to get an idea of what’s available

``` r
levels(as.factor(inputs$variable_names$Variable))
```

    ## [1] "Eastward Wind"                       "Maximum Relative Humidity"          
    ## [3] "Maximum Temperature"                 "Minimum Relative Humidity"          
    ## [5] "Minimum Temperature"                 "Northward Wind"                     
    ## [7] "Precipitation"                       "Specific Humidity"                  
    ## [9] "Surface Downswelling Shortwave Flux"

``` r
levels(as.factor(inputs$variable_names$`Variable abbreviation`))
```

    ## [1] "huss"   "pr"     "rhsmax" "rhsmin" "rsds"   "tasmax" "tasmin" "uas"   
    ## [9] "vas"

``` r
levels(as.factor(inputs$variable_names$Scenario))
```

    ## [1] "RCP 4.5" "RCP 8.5"

``` r
levels(as.factor(inputs$variable_names$`Scenario abbreviation`))
```

    ## [1] "rcp45" "rcp85"

``` r
levels(as.factor(inputs$variable_names$Model))
```

    ##  [1] "Beijing Climate Center - Climate System Model 1.1"                                            
    ##  [2] "Beijing Normal University - Earth System Model"                                               
    ##  [3] "Canadian Earth System Model 2"                                                                
    ##  [4] "Centre National de Recherches Météorologiques - Climate Model 5"                              
    ##  [5] "Commonwealth Scientific and Industrial Research Organisation - Mk3.6.0"                       
    ##  [6] "Community Climate System Model 4"                                                             
    ##  [7] "Geophysical Fluid Dynamics Laboratory - Earth System Model 2 Generalized Ocean Layer Dynamics"
    ##  [8] "Geophysical Fluid Dynamics Laboratory - Earth System Model 2 Modular Ocean"                   
    ##  [9] "Hadley Global Environment Model 2 - Climate Chemistry 365 (day) "                             
    ## [10] "Hadley Global Environment Model 2 - Earth System 365 (day)"                                   
    ## [11] "Institut Pierre Simon Laplace (IPSL) - Climate Model 5A - Low Resolution"                     
    ## [12] "Institut Pierre Simon Laplace (IPSL) - Climate Model 5A - Medium Resolution"                  
    ## [13] "Institut Pierre Simon Laplace (IPSL) - Climate Model 5B - Low Resolution"                     
    ## [14] "Institute of Numerical Mathematics Climate Model 4"                                           
    ## [15] "Meteorological Research Institute - Coupled Global Climate Model 3"                           
    ## [16] "Model for Interdisciplinary Research On Climate - Earth System Model"                         
    ## [17] "Model for Interdisciplinary Research On Climate - Earth System Model - Chemistry"             
    ## [18] "Model for Interdisciplinary Research On Climate 5"                                            
    ## [19] "Norwegian Earth System Model 1 - Medium Resolution"

``` r
levels(as.factor(inputs$variable_names$`Model abbreviation`))
```

    ##  [1] "bcc-csm1-1"     "bcc-csm1-1-m"   "BNU-ESM"        "CanESM2"       
    ##  [5] "CCSM4"          "CNRM-CM5"       "CSIRO-Mk3-6-0"  "GFDL-ESM2G"    
    ##  [9] "GFDL-ESM2M"     "HadGEM2-CC365"  "HadGEM2-ES365"  "inmcm4"        
    ## [13] "IPSL-CM5A-LR"   "IPSL-CM5A-MR"   "IPSL-CM5B-LR"   "MIROC-ESM"     
    ## [17] "MIROC-ESM-CHEM" "MIROC5"         "MRI-CGCM3"      "NorESM1-M"

## But we prefer to use the table version so we can easily select combinations of variables that we want to pull together.

Here you will use tidy notation to filter the available_data table to
only include the entries that you would like to download.

## Filter variable names

This filter includes all of the climate models, all of the scenarios,
and 5 variables. It is a big request.

``` r
input_variables <- inputs$variable_names %>% 
  filter(Variable %in% c("Maximum Relative Humidity", 
                       "Maximum Temperature", 
                       "Minimum Relative Humidity",          
                       "Minimum Temperature",                 
                       "Precipitation")) %>% 
  filter(Scenario %in% c( "RCP 4.5", "RCP 8.5")) %>% 
  filter(Model %in% c(
    "Beijing Climate Center - Climate System Model 1.1",
    "Beijing Normal University - Earth System Model",
    "Canadian Earth System Model 2",                                                                
  "Centre National de Recherches Météorologiques - Climate Model 5",                              
  "Commonwealth Scientific and Industrial Research Organisation - Mk3.6.0",                       
  "Community Climate System Model 4",                                                             
  "Geophysical Fluid Dynamics Laboratory - Earth System Model 2 Generalized Ocean Layer Dynamics",
  "Geophysical Fluid Dynamics Laboratory - Earth System Model 2 Modular Ocean",                   
  "Hadley Global Environment Model 2 - Climate Chemistry 365 (day) ",                             
 "Hadley Global Environment Model 2 - Earth System 365 (day)",                                   
 "Institut Pierre Simon Laplace (IPSL) - Climate Model 5A - Low Resolution",                     
 "Institut Pierre Simon Laplace (IPSL) - Climate Model 5A - Medium Resolution",                  
 "Institut Pierre Simon Laplace (IPSL) - Climate Model 5B - Low Resolution",                     
 "Institute of Numerical Mathematics Climate Model 4",                                           
 "Meteorological Research Institute - Coupled Global Climate Model 3",                           
 "Model for Interdisciplinary Research On Climate - Earth System Model",                         
 "Model for Interdisciplinary Research On Climate - Earth System Model - Chemistry",             
 "Model for Interdisciplinary Research On Climate 5",                                            
 "Norwegian Earth System Model 1 - Medium Resolution"  )) %>%
  
  pull("Available variable")

input_variables
```

    ##   [1] "pr_BNU-ESM_r1i1p1_rcp45"            "pr_BNU-ESM_r1i1p1_rcp85"           
    ##   [3] "pr_CCSM4_r6i1p1_rcp45"              "pr_CCSM4_r6i1p1_rcp85"             
    ##   [5] "pr_CNRM-CM5_r1i1p1_rcp45"           "pr_CNRM-CM5_r1i1p1_rcp85"          
    ##   [7] "pr_CSIRO-Mk3-6-0_r1i1p1_rcp45"      "pr_CSIRO-Mk3-6-0_r1i1p1_rcp85"     
    ##   [9] "pr_CanESM2_r1i1p1_rcp45"            "pr_CanESM2_r1i1p1_rcp85"           
    ##  [11] "pr_GFDL-ESM2G_r1i1p1_rcp45"         "pr_GFDL-ESM2G_r1i1p1_rcp85"        
    ##  [13] "pr_GFDL-ESM2M_r1i1p1_rcp45"         "pr_GFDL-ESM2M_r1i1p1_rcp85"        
    ##  [15] "pr_HadGEM2-CC365_r1i1p1_rcp45"      "pr_HadGEM2-CC365_r1i1p1_rcp85"     
    ##  [17] "pr_HadGEM2-ES365_r1i1p1_rcp45"      "pr_HadGEM2-ES365_r1i1p1_rcp85"     
    ##  [19] "pr_IPSL-CM5A-LR_r1i1p1_rcp45"       "pr_IPSL-CM5A-LR_r1i1p1_rcp85"      
    ##  [21] "pr_IPSL-CM5A-MR_r1i1p1_rcp45"       "pr_IPSL-CM5A-MR_r1i1p1_rcp85"      
    ##  [23] "pr_IPSL-CM5B-LR_r1i1p1_rcp45"       "pr_IPSL-CM5B-LR_r1i1p1_rcp85"      
    ##  [25] "pr_MIROC-ESM-CHEM_r1i1p1_rcp45"     "pr_MIROC-ESM-CHEM_r1i1p1_rcp85"    
    ##  [27] "pr_MIROC-ESM_r1i1p1_rcp85"          "pr_MIROC-ESM_r1i1p1_rcp45"         
    ##  [29] "pr_MIROC5_r1i1p1_rcp45"             "pr_MIROC5_r1i1p1_rcp85"            
    ##  [31] "pr_MRI-CGCM3_r1i1p1_rcp45"          "pr_MRI-CGCM3_r1i1p1_rcp85"         
    ##  [33] "pr_NorESM1-M_r1i1p1_rcp45"          "pr_NorESM1-M_r1i1p1_rcp85"         
    ##  [35] "pr_bcc-csm1-1_r1i1p1_rcp45"         "pr_bcc-csm1-1_r1i1p1_rcp85"        
    ##  [37] "pr_inmcm4_r1i1p1_rcp45"             "pr_inmcm4_r1i1p1_rcp85"            
    ##  [39] "rhsmax_BNU-ESM_r1i1p1_rcp45"        "rhsmax_BNU-ESM_r1i1p1_rcp85"       
    ##  [41] "rhsmax_CNRM-CM5_r1i1p1_rcp45"       "rhsmax_CNRM-CM5_r1i1p1_rcp85"      
    ##  [43] "rhsmax_CSIRO-Mk3-6-0_r1i1p1_rcp45"  "rhsmax_CSIRO-Mk3-6-0_r1i1p1_rcp85" 
    ##  [45] "rhsmax_CanESM2_r1i1p1_rcp45"        "rhsmax_CanESM2_r1i1p1_rcp85"       
    ##  [47] "rhsmax_GFDL-ESM2G_r1i1p1_rcp45"     "rhsmax_GFDL-ESM2G_r1i1p1_rcp85"    
    ##  [49] "rhsmax_GFDL-ESM2M_r1i1p1_rcp45"     "rhsmax_HadGEM2-CC365_r1i1p1_rcp45" 
    ##  [51] "rhsmax_HadGEM2-CC365_r1i1p1_rcp85"  "rhsmax_HadGEM2-ES365_r1i1p1_rcp45" 
    ##  [53] "rhsmax_HadGEM2-ES365_r1i1p1_rcp85"  "rhsmax_IPSL-CM5A-LR_r1i1p1_rcp45"  
    ##  [55] "rhsmax_IPSL-CM5A-LR_r1i1p1_rcp85"   "rhsmax_IPSL-CM5A-MR_r1i1p1_rcp45"  
    ##  [57] "rhsmax_IPSL-CM5A-MR_r1i1p1_rcp85"   "rhsmax_IPSL-CM5B-LR_r1i1p1_rcp45"  
    ##  [59] "rhsmax_IPSL-CM5B-LR_r1i1p1_rcp85"   "rhsmax_MIROC-ESM-CHEM_r1i1p1_rcp45"
    ##  [61] "rhsmax_MIROC-ESM-CHEM_r1i1p1_rcp85" "rhsmax_MIROC-ESM_r1i1p1_rcp45"     
    ##  [63] "rhsmax_MIROC-ESM_r1i1p1_rcp85"      "rhsmax_MIROC5_r1i1p1_rcp45"        
    ##  [65] "rhsmax_MIROC5_r1i1p1_rcp85"         "rhsmax_MRI-CGCM3_r1i1p1_rcp45"     
    ##  [67] "rhsmax_MRI-CGCM3_r1i1p1_rcp85"      "rhsmax_bcc-csm1-1_r1i1p1_rcp45"    
    ##  [69] "rhsmax_bcc-csm1-1_r1i1p1_rcp85"     "rhsmax_inmcm4_r1i1p1_rcp45"        
    ##  [71] "rhsmax_inmcm4_r1i1p1_rcp85"         "rhsmin_BNU-ESM_r1i1p1_rcp45"       
    ##  [73] "rhsmin_BNU-ESM_r1i1p1_rcp85"        "rhsmin_CNRM-CM5_r1i1p1_rcp45"      
    ##  [75] "rhsmin_CNRM-CM5_r1i1p1_rcp85"       "rhsmin_CSIRO-Mk3-6-0_r1i1p1_rcp45" 
    ##  [77] "rhsmin_CSIRO-Mk3-6-0_r1i1p1_rcp85"  "rhsmin_CanESM2_r1i1p1_rcp45"       
    ##  [79] "rhsmin_CanESM2_r1i1p1_rcp85"        "rhsmin_GFDL-ESM2G_r1i1p1_rcp45"    
    ##  [81] "rhsmin_GFDL-ESM2G_r1i1p1_rcp85"     "rhsmin_GFDL-ESM2M_r1i1p1_rcp45"    
    ##  [83] "rhsmin_GFDL-ESM2M_r1i1p1_rcp85"     "rhsmin_HadGEM2-CC365_r1i1p1_rcp45" 
    ##  [85] "rhsmin_HadGEM2-CC365_r1i1p1_rcp85"  "rhsmin_HadGEM2-ES365_r1i1p1_rcp45" 
    ##  [87] "rhsmin_HadGEM2-ES365_r1i1p1_rcp85"  "rhsmin_IPSL-CM5A-LR_r1i1p1_rcp45"  
    ##  [89] "rhsmin_IPSL-CM5A-LR_r1i1p1_rcp85"   "rhsmin_IPSL-CM5A-MR_r1i1p1_rcp45"  
    ##  [91] "rhsmin_IPSL-CM5A-MR_r1i1p1_rcp85"   "rhsmin_IPSL-CM5B-LR_r1i1p1_rcp45"  
    ##  [93] "rhsmin_IPSL-CM5B-LR_r1i1p1_rcp85"   "rhsmin_MIROC-ESM-CHEM_r1i1p1_rcp45"
    ##  [95] "rhsmin_MIROC-ESM-CHEM_r1i1p1_rcp85" "rhsmin_MIROC-ESM_r1i1p1_rcp45"     
    ##  [97] "rhsmin_MIROC-ESM_r1i1p1_rcp85"      "rhsmin_MIROC5_r1i1p1_rcp45"        
    ##  [99] "rhsmin_MIROC5_r1i1p1_rcp85"         "rhsmin_MRI-CGCM3_r1i1p1_rcp45"     
    ## [101] "rhsmin_MRI-CGCM3_r1i1p1_rcp85"      "rhsmin_bcc-csm1-1_r1i1p1_rcp45"    
    ## [103] "rhsmin_bcc-csm1-1_r1i1p1_rcp85"     "rhsmin_inmcm4_r1i1p1_rcp45"        
    ## [105] "rhsmin_inmcm4_r1i1p1_rcp85"         "tasmax_BNU-ESM_r1i1p1_rcp45"       
    ## [107] "tasmax_BNU-ESM_r1i1p1_rcp85"        "tasmax_CCSM4_r6i1p1_rcp45"         
    ## [109] "tasmax_CCSM4_r6i1p1_rcp85"          "tasmax_CNRM-CM5_r1i1p1_rcp45"      
    ## [111] "tasmax_CNRM-CM5_r1i1p1_rcp85"       "tasmax_CSIRO-Mk3-6-0_r1i1p1_rcp45" 
    ## [113] "tasmax_CSIRO-Mk3-6-0_r1i1p1_rcp85"  "tasmax_CanESM2_r1i1p1_rcp45"       
    ## [115] "tasmax_CanESM2_r1i1p1_rcp85"        "tasmax_GFDL-ESM2G_r1i1p1_rcp45"    
    ## [117] "tasmax_GFDL-ESM2G_r1i1p1_rcp85"     "tasmax_GFDL-ESM2M_r1i1p1_rcp45"    
    ## [119] "tasmax_GFDL-ESM2M_r1i1p1_rcp85"     "tasmax_HadGEM2-CC365_r1i1p1_rcp45" 
    ## [121] "tasmax_HadGEM2-CC365_r1i1p1_rcp85"  "tasmax_HadGEM2-ES365_r1i1p1_rcp45" 
    ## [123] "tasmax_HadGEM2-ES365_r1i1p1_rcp85"  "tasmax_IPSL-CM5A-LR_r1i1p1_rcp45"  
    ## [125] "tasmax_IPSL-CM5A-LR_r1i1p1_rcp85"   "tasmax_IPSL-CM5A-MR_r1i1p1_rcp45"  
    ## [127] "tasmax_IPSL-CM5A-MR_r1i1p1_rcp85"   "tasmax_IPSL-CM5B-LR_r1i1p1_rcp45"  
    ## [129] "tasmax_IPSL-CM5B-LR_r1i1p1_rcp85"   "tasmax_MIROC-ESM-CHEM_r1i1p1_rcp45"
    ## [131] "tasmax_MIROC-ESM-CHEM_r1i1p1_rcp85" "tasmax_MIROC-ESM_r1i1p1_rcp45"     
    ## [133] "tasmax_MIROC-ESM_r1i1p1_rcp85"      "tasmax_MIROC5_r1i1p1_rcp45"        
    ## [135] "tasmax_MIROC5_r1i1p1_rcp85"         "tasmax_MRI-CGCM3_r1i1p1_rcp45"     
    ## [137] "tasmax_MRI-CGCM3_r1i1p1_rcp85"      "tasmax_NorESM1-M_r1i1p1_rcp45"     
    ## [139] "tasmax_NorESM1-M_r1i1p1_rcp85"      "tasmax_bcc-csm1-1_r1i1p1_rcp45"    
    ## [141] "tasmax_bcc-csm1-1_r1i1p1_rcp85"     "tasmax_inmcm4_r1i1p1_rcp45"        
    ## [143] "tasmax_inmcm4_r1i1p1_rcp85"         "tasmin_BNU-ESM_r1i1p1_rcp45"       
    ## [145] "tasmin_BNU-ESM_r1i1p1_rcp85"        "tasmin_CCSM4_r6i1p1_rcp45"         
    ## [147] "tasmin_CCSM4_r6i1p1_rcp85"          "tasmin_CNRM-CM5_r1i1p1_rcp45"      
    ## [149] "tasmin_CNRM-CM5_r1i1p1_rcp85"       "tasmin_CSIRO-Mk3-6-0_r1i1p1_rcp45" 
    ## [151] "tasmin_CSIRO-Mk3-6-0_r1i1p1_rcp85"  "tasmin_CanESM2_r1i1p1_rcp45"       
    ## [153] "tasmin_CanESM2_r1i1p1_rcp85"        "tasmin_GFDL-ESM2G_r1i1p1_rcp45"    
    ## [155] "tasmin_GFDL-ESM2G_r1i1p1_rcp85"     "tasmin_GFDL-ESM2M_r1i1p1_rcp45"    
    ## [157] "tasmin_GFDL-ESM2M_r1i1p1_rcp85"     "tasmin_HadGEM2-CC365_r1i1p1_rcp45" 
    ## [159] "tasmin_HadGEM2-CC365_r1i1p1_rcp85"  "tasmin_HadGEM2-ES365_r1i1p1_rcp45" 
    ## [161] "tasmin_HadGEM2-ES365_r1i1p1_rcp85"  "tasmin_IPSL-CM5A-LR_r1i1p1_rcp45"  
    ## [163] "tasmin_IPSL-CM5A-LR_r1i1p1_rcp85"   "tasmin_IPSL-CM5A-MR_r1i1p1_rcp45"  
    ## [165] "tasmin_IPSL-CM5A-MR_r1i1p1_rcp85"   "tasmin_IPSL-CM5B-LR_r1i1p1_rcp45"  
    ## [167] "tasmin_IPSL-CM5B-LR_r1i1p1_rcp85"   "tasmin_MIROC-ESM-CHEM_r1i1p1_rcp45"
    ## [169] "tasmin_MIROC-ESM-CHEM_r1i1p1_rcp85" "tasmin_MIROC-ESM_r1i1p1_rcp45"     
    ## [171] "tasmin_MIROC-ESM_r1i1p1_rcp85"      "tasmin_MIROC5_r1i1p1_rcp45"        
    ## [173] "tasmin_MIROC5_r1i1p1_rcp85"         "tasmin_MRI-CGCM3_r1i1p1_rcp45"     
    ## [175] "tasmin_MRI-CGCM3_r1i1p1_rcp85"      "tasmin_NorESM1-M_r1i1p1_rcp45"     
    ## [177] "tasmin_NorESM1-M_r1i1p1_rcp85"      "tasmin_bcc-csm1-1_r1i1p1_rcp45"    
    ## [179] "tasmin_bcc-csm1-1_r1i1p1_rcp85"     "tasmin_inmcm4_r1i1p1_rcp45"        
    ## [181] "tasmin_inmcm4_r1i1p1_rcp85"

# Climate Futures Toolbox Functions

As previously mentioned, the climate futures toolbox includes two
functions: available_data() and single_point_firehose(). While both of
these functions are used to download data from the MACA climate model,
they have slightly different usage cases which will be described below.

## Available Data Function

The available_data() function can be used to download data from the MACA
climate model. These downloads can include data about multiple variables
for multiple emission scenarios and from multiple climate models over a
desired length of time and over a desired spatial region. However, there
is a 500 MB limit on the size of the download request when using
available_data which limits the amount of data that can be requested in
a download and successfully downloaded. It is possible to submit a
download request that exceeds the 500 MB limit, but the download will
not finish and an error message will be produced, as mentioned above.
Notice that there is no singular cut-off on the number of variables,
emissions scenarios, and climate models can be requested for a given
time period and a given spatial region. If you need to download more
than 500 MB of data, you can either make multiple download requests by
calling available_data multiple times and stitching the data obtained
from those download requests together or you can use the
single_point_firehose function which parallelizes download requests and
combines the data into a single spatial dataframe. An example of how to
make multiple download requests using available_data is shown in the
available_data vignette at:
<https://github.com/earthlab/cft/blob/main/vignettes/available-data.md>.
As is mentioned in the available_data vignette, it is computationally
expensive to stitch the data from multiple download requests using
availabe_data together, so it is easier and more computationally
efficient to use the single_point_firehose function if you encounter
errors when trying to download data using the available_data function.

**Overall, the available_data function works best for downloading MACA
climate model data for several climate variables from several climate
models for any number of emission scenarios over a relatively small
spatial region and over a relatively short time period.**

## Firehose Function

The single_point_firehose() function is also used to download data from
the MACA climate model. Unlike the available_data function, however, the
single_point_firehose function parallelizes multiple download requests
across the cores of your computer. This allows for faster downloading of
data from the MACA climate model and permits users to request data about
multiple climate variables from multiple models and emission scenarios
in their entirety because the download requests are broken up such that
no download request exceeds the 500 MB limit. After the data are
downloaded from the MACA climate model from these parallelized download
requests, the single_point_firehose function combines the data into a
single spatial dataframe. It is important to note that the
single_point_firehose function obtains data from the MACA climate model
for multiple climate variables from multiple models and emission
scenarios in their entirety **for a single lat/long location**. If you
need MACA climate model data for multiple climate variables from
multiple models and emission scenarios in their entirety at multiple
lat/long locations, you will need to make multiple calls to the
single_point_firehose function and combine the data from those requests.
An example of how to use the single_point_firehose function to download
MACA climate model data is shown in the firehose vignette at
<https://github.com/earthlab/cft/blob/main/vignettes/firehose.md>.

**Therefore, the single_point_firehose function works best for
downloading MACA climate model data for multiple climate variables from
multiple climate models and emission scenarios in their entirety for a
single lat/long location.**
